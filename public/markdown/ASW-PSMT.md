# ASW-PSMT
D Cloud Platform을 응용해서 만든 학과 실습 시스템 입니다.

## what is Project?
ASW-PSMT는 동의대학교 응용소프트웨어학과의 교육 및 실습 환경을 지원하기 위해 개발된 특수 목적의 웹 애플리케이션입니다. 주요 목표는 학생들이 서버 시스템을 신청하고 관리하는 과정을 자동화하고 단순화하여, 실습 및 프로젝트 개발에 필요한 인프라에 대한 접근성을 높이는 것이다. 이를 통해 기존의 복잡하고 괸리자 직접 할당해주는 수동적인 서버 할당 절차를 대체하고, 사용자에게 직관적이고 효율적인 관리 경험을 제공할려고 합니다.

## 프로젝트 사용 기술 스택
|제출|기술|역할|
|--------|-------|------|
|프론트 엔드| 	React, TypeScript, NPM | SPA UI 구성, 상태 관리, 모듈화|
|백엔드| 	PHP, Composer | REST API, 비즈니스 로직, 인증 처리|
|데이터베이스| 	MySQL | 사용자, 서버, 요청 등 영속적 데이터 저장|
|배포/인프라| 	Nginx, Docker | 	정적 파일 서빙, API 라우팅, 환경 통제|

## 아키텍처 분리
현재 이 프로젝트나 DCP 프로젝트 같은경우 프론트와 백엔드 아키텍처를 분리하고 사용을 했습니다. 프론트같은 경우 단일 페이지 애플리케이션(SPA)으로 구축하였으면 백엔드는 PHP을 이용해서 RESTful API를 구축했습니다. 그리고 이 트래픽을 제어하는 곳은 Nginx에서 게이트웨이로 사용하여 정적 콘천트 제공과 API 요청을 했습니다.

## 프론트 엔드
프론트엔트같은경우 리액트를 이용해서 만들었으면 내부 디자인 라이브러리 같은경우 Tailwind 하고 shadcn을 이용해서 개발을 했습니다. 디자인 같은경우 Dcp 프로젝트에서 그대로 가지고 왔지만 이 프로젝트 같은경우 자동으로 VM을 만들고 배포를 해주기 때문에 서버 신청하는 부분을 약간 수정했습니다.

## 백엔드
![image](https://github.com/user-attachments/assets/8353e254-a6f9-4f17-9e54-1b4273177e20)

### 서버 자동 생성
백엔드는 PHP와 Mysql을 이용해서 개발을 진행을 했고 Dcp API를 기반으로 제작을 하였습니다. 하지만 Dcp 프로젝트하고 지금 현재 프로젝트의 프로젝트 로직도를 보시면 뭔가 조금 바뀐 부분이 있는데 이 프로젝트같은경우는 사용자가 원하는 타입의 VM을 클론을 해서 정보를 주입을 해서 서버를 생성하는 방식입니다. 그래서 정보를 주입하는 방법은 클라우드나 개인이 개발할때 많이 설정하는 Cloud-init을 이용해서 설정하게 됨니다. 그리고 IP나 포트포워딩 같은경우 관리자가 사전에 설정한 값을 관리자가 서버 신청을 완료하고 생성하기전에 관리자는 IP만 선택해주시면 자동으로 포트포워딩이 되어서 사용자가에게 전달이 됨니다.&nbsp;  
그러면 먼저 Proxmomx는 웹에서 받은 신청정보를 가지고 아래 코드을 이용해서 cloud-init에 필요한 데이터를 가지고 옴니다.
```php
    $sourceVmid = isset($_GET["sourceVmid"]) ? $_GET["sourceVmid"] : null;
    $newVmid = isset($_GET["newVmid"]) ? $_GET["newVmid"] : null;
    $newVmName = isset($_GET["newVmName"]) ? $_GET["newVmName"] : null;
    $ciUser = isset($_GET["ciUser"]) ? $_GET["ciUser"] : null;
    $ciPassword = isset($_GET["ciPassword"]) ? $_GET["ciPassword"] : null;
    $ipAddress = isset($_GET["ipAddress"]) ? $_GET["ipAddress"] : null;

```
그다음 이런 과정을 통해서 서버 생성 정보가 입력이 되면 이제 백엔드에서는 서버에게 서버를 생성해라는 데이터를 보고 서버는 이걸 토대로 서버를 만들게 됨니다.
```php
    $result = Request::Request("/nodes/computer6/qemu/{$sourceVmid}/clone", $cloneParams, 'POST');
```
> 해당 API는 [("라이브 보려가기")](https://github.com/Saleh7/ProxmoxVE_PHP_API) 이곳을 클릭해주시면 좀더 많은 사용법을 보실수 있습니다.

이렇게 서버가 생성을 다하면 백엔드쪽에서 관리자가 이미 설정한 네트워크와 사용자가 입력한 비빈과 ID을 이메일로 전송하게 됨니다.

### 유저 인증
유저 인증 같은경우 보안을 위해 JWT를 채택을 해서 사용합니다. JWT 만료시간 같은경우 2시간 이라는 시간을 자기오 있고 리프레쉬토큰은 1시간 이내로 사용을 하실수 있습니다. 그리고 JWT같은경우 기타 재인증이나 확인용을 위해 데이터베이스에 각각 2개의 키가 저장이 되는데 사용자가 사용을 안하고 다음 로그인을 할경우 데이터베이스에 쓰레기 데이터가 없어지기 위해 1시간 마다 테이블 초기화를 하게 만들었습니다. &nbsp;  
&nbsp;  
사용자 인증에서 JWT는 내부에 특정 갑을 이용해서 데이터베이스에 접근이 가능 하나 jwt는 복구화가 된경우 보안 취약점이 있게 때문에 저희만에 내부적으로 인식하기 위한 패턴을 넣어서 보안을 한층더 높혔습니다.
